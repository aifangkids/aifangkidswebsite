<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AiFangKids é¸å“ - All</title>
    
    <style>
        /* ------------------------------------
            é€šç”¨é‡ç½®èˆ‡å­—é«”è¨­å®š (ç²‰åœ“é«”)
        ------------------------------------ */
        @import url('https://fonts.googleapis.com/css2?family=Huninn&display=swap');

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Huninn', 'Noto Sans TC', Arial, sans-serif; 
            color: #333;
            background-color: #fff;
            line-height: 1.5;
            font-size: 14px; 
        }
        
        a {
            text-decoration: none;
            color: inherit;
        }

        ul {
            list-style: none;
        }
        
        button {
            border: none;
            background: none;
            cursor: pointer;
            padding: 0;
            color: inherit;
            font-family: inherit;
        }

        .wrapper {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* ------------------------------------
            å°èˆªåˆ— (Navbar)
        ------------------------------------ */
        #navbar {
            background-color: #fff;
            border-bottom: 1px solid #eee;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 60px;
        }

        .logo a {
            font-size: 24px;
            font-weight: bold;
            color: #e91e63; /* äº®ç²‰ç´…è‰²ç³» */
        }

        .nav-links {
            display: flex;
            gap: 25px;
        }

        .nav-links a {
            text-transform: uppercase;
            font-size: 14px;
            padding: 5px 0;
            position: relative;
        }

        .nav-links a:hover::after,
        .nav-links a.active::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -5px;
            width: 100%;
            height: 2px;
            background-color: #e91e63;
        }

        .nav-icons {
            display: flex;
            gap: 15px;
            font-size: 18px;
        }

        /* ------------------------------------
            ä¸»å…§å®¹å€ (Main Content)
        ------------------------------------ */
        #main-content {
            padding: 40px 0;
        }

        .product-list-container {
            margin-top: 30px;
        }

        .product-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .product-item {
            text-align: center;
            padding: 10px;
            border: 1px solid #f0f0f0;
            transition: box-shadow 0.3s;
        }

        .product-item:hover {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .product-image img {
            width: 100%;
            height: auto;
            display: block;
            margin-bottom: 10px;
        }

        .product-name {
            display: block;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .price-box {
            margin-top: 5px;
            font-size: 14px;
        }

        .original-price {
            color: #999;
            text-decoration: line-through;
            margin-right: 10px;
        }

        .discount-price {
            color: #e91e63;
            font-weight: bold;
            font-size: 16px;
        }
        
        .color-swatches {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-bottom: 5px;
            height: 15px; /* ç¢ºä¿é«˜åº¦ä¸€è‡´ */
        }
        
        .swatch {
            display: block;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            border: 1px solid #ccc;
        }

        /* ------------------------------------
            Footer
        ------------------------------------ */
        #footer {
            background-color: #333;
            color: #fff;
            padding: 30px 0;
            margin-top: 50px;
        }

        .footer-cols {
            display: flex;
            justify-content: space-between;
            gap: 30px;
            margin-bottom: 20px;
            font-size: 13px;
        }

        .footer-cols h3 {
            margin-bottom: 10px;
            font-size: 16px;
        }

        .copyright {
            border-top: 1px solid #555;
            padding-top: 15px;
            text-align: center;
            font-size: 12px;
        }
    </style>
</head>
<body>
    
    <header id="navbar">
        <div class="wrapper nav-content">
            <div class="logo">
                <a href="index.html">AIFANG KIDS</a>
            </div>
            <nav class="nav-links">
                <a href="index.html" class="active">ALL</a>
                <a href="#">ä¸Šè¡£</a>
                <a href="#">ä¸‹è‘—</a>
                <a href="#">å¤–å¥—</a>
            </nav>
            <div class="nav-icons">
                <a href="#"><i class="fas fa-search"></i></a>
                <a href="cart.html"><i class="fas fa-shopping-cart"></i></a>
                <a href="#"><i class="fas fa-user"></i></a>
            </div>
        </div>
    </header>

    <div id="main-content">
        <div class="wrapper">
            <h2>æ‰€æœ‰ç”¢å“</h2>
            
            <div class="product-list-container">
                <ul class="product-list" id="product-list">
                    <li>è¼‰å…¥ç”¢å“ä¸­...</li> 
                </ul>
            </div>
            
        </div>
    </div>

    <footer id="footer">
        <div class="wrapper footer-cols">
            <div class="customer-center">
                <h3>CUSTOMER CENTER</h3>
                <p>MAIL: aifangkids@gmail.com</p>
                <p>æœå‹™æ™‚é–“: AM 10:00 - PM 21:00</p>
                <p>é€±æœ«èˆ‡åœ‹å®šå‡æ—¥ä¼‘æ¯ï¼Œè¨‚å–®åŠå‡ºè²¨å°‡æ–¼å·¥ä½œæ—¥ç‚ºæ‚¨è™•ç†</p>
            </div>
            <div class="company-info">
                <h3>COMPANY INFO</h3>
                <p>å…¬å¸åç¨±: ç’¦åŠç«¥è£</p>
                <p>çµ±ä¸€ç·¨è™Ÿ: 95294390</p>
            </div>
        </div>
        <div class="copyright wrapper">
            <p>Copyright Â© **Aifang Kids Studio** All rights reserved.</p>
        </div>
    </footer>

    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

    <script>
        // =========================================================
        // ğŸš¨ ä¿®æ­£é» 1: æ•´åˆæ‚¨çš„ Google Apps Script URL
        // =========================================================
        const GAS_URL = 'https://script.google.com/macros/s/AKfycbxj1KQbiB3Q4aJAIJDJ_LcIbddkkrBNeCS_J1Wo44JbGZW6KpjmhmHxemURciWA8p6QyA/exec'; 

        // å–å¾—ç”¢å“æ¸…å–®å®¹å™¨
        const productListEl = document.getElementById('product-list');

        /**
         * æ ¹æ“šç”¢å“è³‡æ–™ç‰©ä»¶ï¼Œç”Ÿæˆå–®ä¸€ç”¢å“çš„ HTML å¡ç‰‡ã€‚
         * @param {Object} product - å–®ä¸€ç”¢å“è³‡æ–™ç‰©ä»¶ã€‚
         * @returns {string} ç”¢å“å¡ç‰‡çš„ HTML å­—ç¬¦ä¸²ã€‚
         */
        function createProductCard(product) {
            // =========================================================
            // ğŸš¨ ä¿®æ­£é» 2: ä¾æ“š JSON æ•¸æ“šï¼Œä¿®æ­£æ‰€æœ‰æ¬„ä½åç¨±ç‚ºå¤§å¯«
            // =========================================================
            
            const productCode = product.Code; // ä½¿ç”¨ Code ä½œç‚º ID
            const productName = product.Name || 'ç„¡åç¨±ç”¢å“';
            
            // åƒ¹æ ¼æ¬„ä½ä¿®æ­£ï¼šä½¿ç”¨æ­£ç¢ºçš„å¤§å¯«æ¬„ä½åç¨±
            const originalPrice = parseFloat(product.Price_Original) || 0;
            // è™•ç†å¸¶æœ‰ç‰¹æ®Šç¬¦è™Ÿçš„æ¬„ä½åç¨± (ä¾‹å¦‚ Price-20%OFF)
            const discountPrice = parseFloat(product['Price-20%OFF']) || 0; 
            
            // åœ–ç‰‡ URL ä¿®æ­£ï¼šä½¿ç”¨æ­£ç¢ºçš„å¤§å¯«æ¬„ä½åç¨±
            const imageUrl = product.MainImage_URL || '/images/placeholder.jpg';

            // --- é¡è‰²é¡¯ç¤ºé‚è¼¯ (è§£æ ColorImages æ¬„ä½) ---
            let colorNames = [];
            if (product.ColorImages) {
                // ç§»é™¤æ›è¡Œç¬¦è™Ÿï¼Œä¸¦ä»¥åˆ†è™Ÿï¼ˆï¼›ï¼‰åˆ†éš”æ¯å€‹é¡è‰²é …ç›®
                const colorItems = String(product.ColorImages).replace(/\n/g, '').split('ï¼›'); 
                
                colorNames = colorItems.map(item => {
                    // åˆ†å‰²é¡è‰²åç¨±å’Œåœ–ç‰‡è·¯å¾‘
                    const parts = item.trim().split('#/');
                    return parts.length > 0 ? parts[0] : ''; // å–å¾—é¡è‰²åç¨±
                }).filter(name => name.length > 0)
                  .slice(0, 4); // æœ€å¤šé¡¯ç¤º 4 å€‹é¡è‰²/èŠ±ç´‹
            }
            
            // ç°¡æ˜“çš„é¡è‰²ä»£ç¢¼å°æ‡‰è¡¨ (è«‹æ³¨æ„ï¼Œé€™è£¡ä½¿ç”¨é€šç”¨é¡è‰²ï¼Œä½†æ¨™é¡Œæœƒé¡¯ç¤ºæ‚¨çš„è‡ªå®šç¾©åç¨±)
            const colorMap = {
                'é»‘ç™½æ ¼ç´‹': '#4A4A4A',
                'è´è¶çµ': '#FFB6C1', 
                'ç´…æ ¼ç´‹': '#B71C1C',
                'è±¹ç´‹': '#B8860B',
                'é»‘ç™½åœ“é»': '#333333',
                'ç´…ç™½åœ“é»': '#FF8A80',
                'ç™½': '#E0E0E0',
                'é»‘': '#333333',
                'ç±³': '#F5F5DC',
                'ç²‰': '#FFC0CB',
                'ç°': '#CCCCCC'
            };
            
            const colorSwatchesHtml = colorNames.map(colorName => {
                // å˜—è©¦åŒ¹é…é¡è‰²ä»£ç¢¼ï¼Œå¦å‰‡ä½¿ç”¨ç°è‰²
                const colorCode = colorMap[colorName] || '#999999'; 
                
                // å°‡é¡è‰²åç¨±å„²å­˜åœ¨ title ä¸­ï¼Œæ»‘é¼ æ‡¸åœæ™‚å¯é¡¯ç¤º
                return `<span class="swatch" title="${colorName}" style="background-color: ${colorCode};"></span>`;
            }).join('');

            return `
                <li class="product-item">
                    <a href="detail.html?id=${productCode}" class="product-link">
                        <div class="product-image">
                            <img src="${imageUrl}" alt="${productName}">
                        </div>
                    </a>
                    <div class="product-info">
                        <div class="color-swatches">
                            ${colorSwatchesHtml}
                        </div>
                    </div>
                    <a href="detail.html?id=${productCode}" class="product-name">${productName}</a>
                    <div class="price-box">
                        <span class="original-price">${originalPrice.toFixed(0)} TWD</span>
                        <span class="discount-price">${discountPrice.toFixed(0)} TWD</span>
                    </div>
                </li>
            `;
        }

        /**
         * æŠ“å– Apps Script çš„è³‡æ–™ä¸¦æ¸²æŸ“åˆ°ç¶²é ä¸Šã€‚
         */
        async function fetchAndRenderProducts() {
            // é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
            if (productListEl) {
                productListEl.innerHTML = '<li style="text-align: center; width: 100%;">æ­£åœ¨å¾ Google è©¦ç®—è¡¨è¼‰å…¥ç”¢å“è³‡æ–™...</li>';
            }

            try {
                const response = await fetch(GAS_URL);
                const products = await response.json(); 

                if (productListEl) {
                    if (products && Array.isArray(products) && products.length > 0) {
                        // å°‡æ‰€æœ‰ç”¢å“å¡ç‰‡ HTML çµ„åˆèµ·ä¾†
                        const htmlContent = products.map(createProductCard).join('');
                        productListEl.innerHTML = htmlContent;
                    } else {
                        productListEl.innerHTML = '<li style="text-align: center; width: 100%;">ç›®å‰æ²’æœ‰ä»»ä½•ç”¢å“ã€‚</li>';
                    }
                }

            } catch (error) {
                console.error('è®€å–ç”¢å“è³‡æ–™å¤±æ•—:', error);
                if (productListEl) {
                    productListEl.innerHTML = '<li style="text-align: center; width: 100%; color: red;">è¼‰å…¥è³‡æ–™å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯æˆ– Apps Script URLã€‚</li>';
                }
            }
        }

        // é é¢è¼‰å…¥æ™‚åŸ·è¡Œä¸€æ¬¡
        window.onload = () => {
            fetchAndRenderProducts();
        };
    </script>
</body>
</html>